<!doctype html>
<html>
	<head>
		<style>
			.key {
				width: 100px;
				height: 300px;
				float: left;
				border: 1px solid black;
			}
			.key.black {
				width: 70px;
				height: 200px;
				background-color: black;
				position: relative;
				left: 64px;
			}
			.pressed, .key.black.pressed {
				background-color: red;
			}
		</style>
		<script>
			var inputs;

			function addDevices() {
				var i,
					select = document.getElementById('selDevices'),
					option;

				for(i = 0; i < inputs.length; i++) {
					option = document.createElement('option');				
					option.text = inputs[i].name;
					select.add(option);	
				}
			}
			function init() {
				document.getElementById('selDevices').onchange = function() {
					console.log('changed');
				}
			}

			navigator.requestMIDIAccess().then(function(res){
				console.log(res.inputs());
				inputs = res.inputs();
				addDevices();
				inputs[2].onmidimessage = function(note){
					// console.log(note.data);
					console.log(numberToNote(note.data[1]));
					// if(note.data[1] === 60) {
						var key = document.getElementById(numberToNote(note.data[1]));
						key.classList.toggle('pressed');
					// }
				};
			});
			function numberToNote(num) {
				var note = num % 12;
				if(note === 0) {
					return "C";
				}
				else if(note === 1) {
					return "Csharp";
				}
				else if(note === 2) {
					return "D";
				}
				else if(note === 3) {
					return "Dsharp";
				}
				else if(note === 4) {
					return "E";
				}
				else if(note === 5) {
					return "F";
				}
				else if(note === 6) {
					return "Fsharp";
				}
				else if(note === 7) {
					return "G";
				}
				else if(note === 8) {
					return "Gsharp";
				}
				else if(note === 9) {
					return "A";
				}
				else if(note === 10) {
					return "Asharp";
				}
				else if(note === 11) {
					return "B";
				}
			}
		</script>
	</head>
	<body onload="init();">
		<h1>Midi Quiz</h1>
		<select id="selDevices"></select>
		<br>
		<div id="C" class="key">
			<div id="Csharp" class="key black"></div>
		</div>
		<div id="D" class="key">
			<div id="Dsharp" class="key black"></div>
		</div>
		<div id="E" class="key"></div>
		<div id="F" class="key">
			<div id="Fsharp" class="key black"></div>
		</div>
		<div id="G" class="key">
			<div id="Gsharp" class="key black"></div>
		</div>
		<div id="A" class="key">
			<div id="Asharp" class="key black"></div>
		</div>
		<div id="B" class="key"></div>
	</body>
</html>
